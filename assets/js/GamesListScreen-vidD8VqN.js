var N=Object.defineProperty,M=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var z=(s,a,l)=>a in s?N(s,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):s[a]=l,j=(s,a)=>{for(var l in a||(a={}))X.call(a,l)&&z(s,l,a[l]);if(P)for(var l of P(a))Y.call(a,l)&&z(s,l,a[l]);return s},y=(s,a)=>M(s,U(a));import{j as e,N as q,G as J,L as K,g as Q,a as W}from"./index-Cuv5go1C.js";import{L as B,r as p}from"./react-vendor-DgpUeLgh.js";import{b as k,S as w,T as b,e as D,g as E,P as Z,D as F,h as ee,i as se,j as te,k as ae,l as le,B as ne,m as oe,R as I,c as S,n as ie}from"./antd-vendor-CDUEeTY9.js";import{u as re}from"./blurhash-vendor-BpTv79Zu.js";import{S as de,a as ce,F as he}from"./antd-icons-CT95X-8W.js";const pe=new Intl.DateTimeFormat("ru-RU");function xe(s){return[{key:"developer",label:"Developer",children:s.developer},{key:"release_date",label:"Release date",children:pe.format(s.release_date)}]}function fe(){return e.jsxs(k,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx(w,{active:!0,paragraph:!1}),e.jsx(w.Image,{active:!0,style:{width:"100%",height:200}}),e.jsx(w,{active:!0,title:!1})]})}function me(s){return e.jsxs(k,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.1)",transition:"box-shadow 0.3s ease",height:"fit-content"},cover:e.jsx(B,{to:`/game/${s.id}`,style:{display:"block"},children:e.jsx("div",{style:{overflow:"hidden",borderRadius:"8px 8px 0 0",cursor:"pointer",backgroundColor:"#f5f5f5",display:"flex",alignItems:"center",justifyContent:"center",minHeight:"200px"},children:e.jsx(ee,{alt:s.title,preview:!1,src:s.thumbnail,width:"100%",height:"100%",style:{maxHeight:"250px",objectFit:"fill",transition:"transform 0.3s ease"},placeholder:s.thumbnail_lazy&&e.jsx(re,{hash:s.thumbnail_lazy.hash,width:s.thumbnail_lazy.w,height:s.thumbnail_lazy.h,resolutionX:32,resolutionY:32,punch:1})})})}),children:[e.jsx(B,{to:`/game/${s.id}`,style:{textDecoration:"none"},children:e.jsx(b,{level:4,style:{margin:"0 0 12px 0",color:"#1890ff",transition:"color 0.3s ease",cursor:"pointer"},children:s.title})}),e.jsxs(D,{wrap:!0,style:{marginBottom:12},children:[e.jsx(E,{color:"blue",children:s.genre}),s.platform&&s.platform.map(a=>e.jsx(E,{color:"green",children:a},a))]}),e.jsx(Z,{ellipsis:{rows:2},style:{color:"#666",fontSize:"14px",marginBottom:12,minHeight:44},children:s.short_description}),e.jsx(F,{column:1,items:xe(s),size:"small",style:{fontSize:"12px"}})]})}function ge({games:s,isLoading:a,error:l,onRetry:r}){const[t,d]=p.useState(1),[i,n]=p.useState(10),m=p.useRef(null),g=s.slice(i*(t-1),i*t),x=(c,h)=>{var v;d(c),n(h),(v=m.current)==null||v.scrollIntoView({behavior:"smooth"})};if((t-1)*i>s.length&&d(1),a)return e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(400px, 1fr))",gap:"16px",marginBottom:"24px"},children:new Array(6).fill(0).map((c,h)=>e.jsx(fe,{},h))});if(l){const c=l.message.toLowerCase();return c.includes("network")||c.includes("fetch")||c.includes("connection")?e.jsx(q,{onRetry:r,title:"Failed to Load Games"}):e.jsx(J,{error:l,onRetry:r,title:"Failed to Load Games"})}return e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:m,style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"16px",marginBottom:"24px"},children:g.map(c=>e.jsx(me,j({},c),c.id))}),e.jsx(se,{current:t,defaultCurrent:t,defaultPageSize:i,style:{marginBottom:30,textAlign:"center"},onChange:x,total:s.length})]})}function G({options:s,checkboxMaxCount:a=7,placeholder:l,defaultValue:r,onChange:t,mode:d="tags",style:i}){const n=x=>{g(x.target.value)},m=x=>{g(x)},g=x=>{t(x)};return s.length>a?e.jsx(te,{mode:d,allowClear:!0,style:i||{width:"100%"},placeholder:l,defaultValue:r,onChange:g,options:s}):d==="multiple"?e.jsx(ae.Group,{style:i||{width:"100%",display:"flex",flexDirection:"column"},options:s,defaultValue:[r],onChange:m}):e.jsx(le.Group,{style:i||{width:"100%",display:"flex",flexDirection:"column"},defaultValue:r,onChange:n,options:s})}function ue({isAscending:s,onDirectionChange:a}){const l=s?e.jsx(de,{}):e.jsx(ce,{});return e.jsx(ne,{icon:l,shape:"circle",onClick:a})}function je({sortMethod:s,possibleValues:a,onSomeFilterChanged:l,onSortMethodChanged:r,currentFilter:t}){const d={title:"Title",release_date:"Release date"};if(!a)return e.jsx(e.Fragment,{});const i=()=>{r(y(j({},s),{isAscending:!s.isAscending}))};return e.jsx(k,{title:e.jsxs(D,{children:[e.jsx(he,{}),e.jsx("span",{children:"Filters & Sorting"})]}),style:{marginBottom:16,borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},bodyStyle:{padding:"16px 20px"},children:e.jsxs(D,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs("div",{children:[e.jsx(b,{level:4,style:{margin:"0 0 12px 0",color:"#1890ff"},children:"Genre"}),e.jsx(G,{mode:"multiple",style:{width:"100%"},placeholder:"Select genres...",defaultValue:void 0,onChange:n=>l(y(j({},t),{genre:n,platform:(t==null?void 0:t.platform)||[],publisher:(t==null?void 0:t.publisher)||[],developer:(t==null?void 0:t.developer)||[],release_date:(t==null?void 0:t.release_date)||null})),options:a.genre.map(n=>({label:n,value:n}))})]}),e.jsxs("div",{children:[e.jsx(b,{level:4,style:{margin:"0 0 12px 0",color:"#1890ff"},children:"Platform"}),e.jsx(G,{mode:"multiple",style:{width:"100%"},placeholder:"Select platforms...",defaultValue:void 0,onChange:n=>l(y(j({},t),{platform:n,genre:(t==null?void 0:t.genre)||[],publisher:(t==null?void 0:t.publisher)||[],developer:(t==null?void 0:t.developer)||[],release_date:(t==null?void 0:t.release_date)||null})),options:a.platform.map(n=>({label:n,value:n}))})]}),e.jsx(oe,{style:{margin:"0px 0"}}),e.jsxs("div",{children:[e.jsx(b,{level:4,style:{margin:"0 0 12px 0",color:"#1890ff"},children:"Sort by"}),e.jsxs(I,{gutter:8,children:[e.jsx(S,{span:18,children:e.jsx(G,{placeholder:"Sort by...",defaultValue:"title",onChange:n=>r(y(j({},s),{field:n})),options:Object.keys(d).map(n=>({label:d[n],value:n})),style:{width:"100%"}})}),e.jsx(S,{span:6,children:e.jsx(ue,{isAscending:s.isAscending,onDirectionChange:i})})]})]})]})})}function Ge(){const[s,a]=p.useState(!0),[l,r]=p.useState([]),[t,d]=p.useState(),[i,n]=p.useState(),[m,g]=p.useState({field:"title",isAscending:!0}),[x,c]=p.useState(null),[h,v]=p.useState(),T=(o,f)=>{if(!o||!o.length||!f||!f.length)return!1;for(const u of o)if(f.includes(u))return!0;return!1},V=o=>{const f=h==null?void 0:h.genre,u=h==null?void 0:h.platform;return!(f&&f.length>0&&!f.includes(o.genre)||u&&u.length>0&&!T(u,o.platform))},O=(o,f)=>{const{field:u,isAscending:$}=m,R=u,_=o[R],A=f[R];return $?A<_?1:-1:A>_?1:-1},L=()=>{a(!0),d(void 0),Q().then(o=>r(o),o=>d(o)).finally(()=>a(!1))},H=()=>{n(void 0),W().then(o=>c(o),o=>n(o))};p.useEffect(()=>{L(),H()},[]);const C=l.filter(V).sort(O);return e.jsx(ie,{style:{padding:"24px 50px"},children:e.jsxs(I,{gutter:24,children:[e.jsx(S,{lg:5,xl:4,children:e.jsxs("div",{style:{marginTop:16},children:[i&&e.jsx(K,{error:i}),e.jsx(je,{currentFilter:h,sortMethod:m,possibleValues:x,onSortMethodChanged:o=>g(o),onSomeFilterChanged:o=>v(o)})]})}),e.jsxs(S,{lg:{span:16,offset:1},xl:{span:17,offset:1},xxl:{span:15,offset:2},children:[e.jsx(b,{level:1,children:C.length>0?`Free to Game ${C.length} games`:"Free to Game"}),e.jsx(ge,{isLoading:s,error:t,games:C,onRetry:L})]})]})})}export{Ge as GamesListScreen,Ge as default};
