var $=Object.defineProperty,N=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var R=(s,a,o)=>a in s?$(s,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[a]=o,u=(s,a)=>{for(var o in a||(a={}))X.call(a,o)&&R(s,o,a[o]);if(L)for(var o of L(a))Y.call(a,o)&&R(s,o,a[o]);return s},j=(s,a)=>N(s,U(a));import{j as e,N as q,G as J,L as K,g as Q,a as W}from"./index-BFDD0X4y.js";import{L as z,r as x}from"./react-vendor-DgpUeLgh.js";import{b as G,S,T as y,e as w,g as P,P as Z,D as F,h as ee,i as se,j as te,k as ae,l as oe,R as B,c as b,m as le,B as ne,n as ie}from"./antd-vendor-CDUEeTY9.js";import{u as re}from"./blurhash-vendor-BpTv79Zu.js";import{F as de,S as ce,a as he}from"./antd-icons-CT95X-8W.js";const xe=new Intl.DateTimeFormat("ru-RU");function pe(s){return[{key:"developer",label:"Developer",children:s.developer},{key:"release_date",label:"Release date",children:xe.format(s.release_date)}]}function fe(){return e.jsxs(G,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx(S,{active:!0,paragraph:!1}),e.jsx(S.Image,{active:!0,style:{width:"100%",height:200}}),e.jsx(S,{active:!0,title:!1})]})}function me(s){return e.jsxs(G,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.1)",transition:"box-shadow 0.3s ease",height:"fit-content"},cover:e.jsx(z,{to:`/game/${s.id}`,style:{display:"block"},children:e.jsx("div",{style:{overflow:"hidden",borderRadius:"8px 8px 0 0",cursor:"pointer",backgroundColor:"#f5f5f5",display:"flex",alignItems:"center",justifyContent:"center",minHeight:"200px"},children:e.jsx(ee,{alt:s.title,preview:!1,src:s.thumbnail,width:"100%",height:"100%",style:{maxHeight:"250px",objectFit:"fill",transition:"transform 0.3s ease"},placeholder:s.thumbnail_lazy&&e.jsx(re,{hash:s.thumbnail_lazy.hash,width:s.thumbnail_lazy.w,height:s.thumbnail_lazy.h,resolutionX:32,resolutionY:32,punch:1})})})}),children:[e.jsx(z,{to:`/game/${s.id}`,style:{textDecoration:"none"},children:e.jsx(y,{level:4,style:{margin:"0 0 12px 0",color:"#1890ff",transition:"color 0.3s ease",cursor:"pointer"},children:s.title})}),e.jsxs(w,{wrap:!0,style:{marginBottom:12},children:[e.jsx(P,{color:"blue",children:s.genre}),s.platform&&s.platform.map(a=>e.jsx(P,{color:"green",children:a},a))]}),e.jsx(Z,{ellipsis:{rows:2},style:{color:"#666",fontSize:"14px",marginBottom:12,minHeight:44},children:s.short_description}),e.jsx(F,{column:1,items:pe(s),size:"small",style:{fontSize:"12px"}})]})}function ge({games:s,isLoading:a,error:o,onRetry:d}){const[t,h]=x.useState(1),[r,l]=x.useState(10),g=(i,c)=>{h(i),l(c),window.scrollTo({top:0,behavior:"smooth"})};if(a)return e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(400px, 1fr))",gap:"16px",marginBottom:"24px"},children:new Array(6).fill(0).map((i,c)=>e.jsx(fe,{},c))});if(o){const i=o.message.toLowerCase();return i.includes("network")||i.includes("fetch")||i.includes("connection")?e.jsx(q,{onRetry:d,title:"Failed to Load Games"}):e.jsx(J,{error:o,onRetry:d,title:"Failed to Load Games"})}return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"16px",marginBottom:"24px"},children:s.slice(r*(t-1),r*t).map(i=>e.jsx(me,u({},i),i.id))}),e.jsx(se,{defaultCurrent:t,defaultPageSize:r,style:{marginBottom:30,textAlign:"center"},onChange:g,total:s.length})]})}function C({options:s,checkboxMaxCount:a=7,placeholder:o,defaultValue:d,onChange:t,mode:h="tags",style:r}){const l=c=>{i(c.target.value)},g=c=>{i(c)},i=c=>{t(c)};return s.length>a?e.jsx(te,{mode:h,allowClear:!0,style:r||{width:"100%"},placeholder:o,defaultValue:d,onChange:i,options:s}):h==="multiple"?e.jsx(ae.Group,{style:r||{width:"100%",display:"flex",flexDirection:"column"},options:s,defaultValue:[d],onChange:g}):e.jsx(oe.Group,{style:r||{width:"100%",display:"flex",flexDirection:"column"},defaultValue:d,onChange:l,options:s})}function ue({isAscending:s,onDirectionChange:a}){const o=s?e.jsx(ce,{}):e.jsx(he,{});return e.jsx(ne,{icon:o,shape:"circle",onClick:a})}function je({sortMethod:s,possibleValues:a,onSomeFilterChanged:o,onSortMethodChanged:d,currentFilter:t}){const h={title:"Title",release_date:"Release date"};if(!a)return e.jsx(e.Fragment,{});const r=()=>{d(j(u({},s),{isAscending:!s.isAscending}))};return e.jsx(G,{title:e.jsxs(w,{children:[e.jsx(de,{}),e.jsx("span",{children:"Filters & Sorting"})]}),style:{marginBottom:16,borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},bodyStyle:{padding:"16px 20px"},children:e.jsxs(w,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs("div",{children:[e.jsx(y,{level:4,style:{margin:"0 0 12px 0",color:"#1890ff"},children:"Sort by"}),e.jsxs(B,{gutter:8,children:[e.jsx(b,{span:18,children:e.jsx(C,{placeholder:"Sort by...",defaultValue:"title",onChange:l=>d(j(u({},s),{field:l})),options:Object.keys(h).map(l=>({label:h[l],value:l})),style:{width:"100%"}})}),e.jsx(b,{span:6,children:e.jsx(ue,{isAscending:s.isAscending,onDirectionChange:r})})]})]}),e.jsx(le,{style:{margin:"16px 0"}}),e.jsxs("div",{children:[e.jsx(y,{level:4,style:{margin:"0 0 12px 0",color:"#1890ff"},children:"Genre"}),e.jsx(C,{mode:"multiple",style:{width:"100%"},placeholder:"Select genres...",defaultValue:void 0,checkboxMaxCount:50,onChange:l=>o(j(u({},t),{genre:l,platform:(t==null?void 0:t.platform)||[],publisher:(t==null?void 0:t.publisher)||[],developer:(t==null?void 0:t.developer)||[],release_date:(t==null?void 0:t.release_date)||null})),options:a.genre.map(l=>({label:l,value:l}))})]}),e.jsxs("div",{children:[e.jsx(y,{level:4,style:{margin:"0 0 12px 0",color:"#1890ff"},children:"Platform"}),e.jsx(C,{mode:"multiple",style:{width:"100%"},placeholder:"Select platforms...",defaultValue:void 0,checkboxMaxCount:50,onChange:l=>o(j(u({},t),{platform:l,genre:(t==null?void 0:t.genre)||[],publisher:(t==null?void 0:t.publisher)||[],developer:(t==null?void 0:t.developer)||[],release_date:(t==null?void 0:t.release_date)||null})),options:a.platform.map(l=>({label:l,value:l}))})]})]})})}function Ge(){const[s,a]=x.useState(!0),[o,d]=x.useState([]),[t,h]=x.useState(),[r,l]=x.useState(),[g,i]=x.useState({field:"title",isAscending:!0}),[c,T]=x.useState(null),[f,E]=x.useState(),I=(n,p)=>{if(!n||!n.length||!p||!p.length)return!1;for(const m of n)if(p.includes(m))return!0;return!1},V=n=>{const p=f==null?void 0:f.genre,m=f==null?void 0:f.platform;return!(p&&p.length>0&&!p.includes(n.genre)||m&&m.length>0&&!I(m,n.platform))},O=(n,p)=>{const{field:m,isAscending:M}=g,k=m,_=n[k],A=p[k];return M?A<_?1:-1:A>_?1:-1},D=()=>{a(!0),h(void 0),Q().then(n=>d(n),n=>h(n)).finally(()=>a(!1))},H=()=>{l(void 0),W().then(n=>T(n),n=>l(n))};x.useEffect(()=>{D(),H()},[]);const v=o.filter(V).sort(O);return e.jsx(ie,{style:{padding:"24px 50px"},children:e.jsxs(B,{gutter:24,children:[e.jsx(b,{lg:5,xl:4,children:e.jsxs("div",{style:{marginTop:16},children:[r&&e.jsx(K,{error:r}),e.jsx(je,{currentFilter:f,sortMethod:g,possibleValues:c,onSortMethodChanged:n=>i(n),onSomeFilterChanged:n=>E(n)})]})}),e.jsxs(b,{lg:{span:16,offset:1},xl:{span:17,offset:1},xxl:{span:15,offset:2},children:[e.jsx(y,{level:1,children:v.length>0?`Free to Game ${v.length} games`:"Free to Game"}),e.jsx(ge,{isLoading:s,error:t,games:v,onRetry:D})]})]})})}export{Ge as GamesListScreen,Ge as default};
